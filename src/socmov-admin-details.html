<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html"><link rel="import" href="../bower_components/paper-dialog/paper-dialog.html"><link rel="import" href="../bower_components/paper-input/paper-input.html"><link rel="import" href="../bower_components/paper-toggle-button/paper-toggle-button.html"><link rel="import" href="../bower_components/paper-button/paper-button.html"><link rel="import" href="../bower_components/iron-icons/iron-icons.html"><link rel="import" href="../bower_components/app-storage/app-network-status-behavior.html"><link rel="import" href="../bower_components/polymerfire/firebase-query.html"><link rel="import" href="../bower_components/polymerfire/firebase-document.html"><link rel="import" href="../bower_components/vaadin-grid/vaadin-grid.html"><link rel="import" href="../bower_components/neon-animation/animations/scale-up-animation.html"><link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html"><link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html"><link rel="import" href="../bower_components/vaadin-date-picker/vaadin-date-picker.html"><link rel="import" href="shared-styles.html"></head><body><dom-module id="socmov-admin-details"><template><style include="shared-styles iron-flex iron-flex-alignment">:host{display:block;padding:10px;}h1{margin:16px 50px 16px 0px;}paper-button{margin-top:10px;}.primaryButton{background-color:var(--paper-blue-500);color:white;}.form{padding:20px;}paper-toggle-button{display:inline-block;}paper-icon-button[hidden], social-media-icons[hidden]{display:none;}paper-input{padding-right:20px;}input[readonly]{border:2px solid transparent;}.page-header{@apply --layout-horizontal;}.page-filter{padding:20px 20px 0px 0px;}.newConference{padding-bottom:30px;}</style><firebase-query id="conferenceQuery" app-name="socmov" path="/conferenceDetails" data="{{conferenceList}}"></firebase-query><firebase-document id="conferenceDoc" app-name="socmov" data="{{conferenceData}}"></firebase-document><div class="card"><div class="page-header"><div><h1>Conferences</h1></div><div class="flex"></div><div class="page-filter"><paper-toggle-button checked="{{_filterActive}}" slot="filter"></paper-toggle-button></div></div><div class="layout horizontal newConference"><paper-input id="name" type="text" placeholder="Name" required="" error-message="Please enter a name" value="{{conferenceData.name}}"></paper-input><paper-input id="location" type="text" placeholder="Location" required="" error-message="Please enter a location" value="{{conferenceData.location}}"></paper-input><paper-input id="year" type="text" placeholder="Year (e.g. 2017)" required="" error-message="Please enter a year" value="{{conferenceData.year}}"></paper-input><paper-input id="startDate" type="date" placeholder="Start Date" value="{{conferenceData.startDate}}"></paper-input><paper-input id="endDate" type="date" placeholder="End Date" value="{{conferenceData.endDate}}"></paper-input><paper-button on-tap="_create" class="primaryButton">Add</paper-button></div><vaadin-grid aria-label="Conferences" items="[[filteredConferenceList]]" id="grid"><vaadin-grid-column><template class="header">Name</template><template><input id="name-[[index]]" value="[[item.name]]" on-input="_storeName" readonly$="[[!_isEditing(editing, item)]]"></template></vaadin-grid-column><vaadin-grid-column><template class="header">Location</template><template><input id="location-[[index]]" value="[[item.location]]" on-input="_storeLocation" readonly$="[[!_isEditing(editing, item)]]"></template></vaadin-grid-column><vaadin-grid-column><template class="header">Year</template><template><input id="year-[[index]]" value="[[item.year]]" on-input="_storeYear" readonly$="[[!_isEditing(editing, item)]]"></template></vaadin-grid-column><vaadin-grid-column><template class="header">Start Date</template><template><input type="date" id="startDate-[[index]]" value="[[item.startDate]]" on-input="_storeStartDate" readonly$="[[!_isEditing(editing, item)]]"></template></vaadin-grid-column><vaadin-grid-column><template class="header">End Date</template><template><input type="date" id="endDate-[[index]]" value="[[item.endDate]]" on-input="_storeEndDate" readonly$="[[!_isEditing(editing, item)]]"></template></vaadin-grid-column><vaadin-grid-column><template><div style="display: flex"><paper-icon-button icon="icons:create" hidden="[[editing]]" on-tap="_edit" focus-target$="[[!editing]]"></paper-icon-button><paper-icon-button icon="icons:save" hidden="[[!_isEditing(editing, item)]]" on-tap="_save" focus-target$="[[editing]]"></paper-icon-button><paper-icon-button icon="icons:cancel" hidden="[[!_isEditing(editing, item)]]" on-tap="_cancel"></paper-icon-button><paper-icon-button icon="icons:remove-circle" hidden$="[[!_isActive(editing, item)]]" on-tap="_toggleActive"></paper-icon-button><paper-icon-button icon="icons:restore" hidden$="[[_isActive(editing, item)]]" on-tap="_toggleActive"></paper-icon-button><paper-icon-button icon="icons:delete-forever" hidden$="[[_isActive(editing, item)]]" on-tap="_delete"></paper-icon-button></div></template></vaadin-grid-column></vaadin-grid></div></template><script>class SocmovAdminConferenceDetails extends Polymer.Element{static get is(){return'socmov-admin-details'}static get properties(){return{conferenceList:{type:Object},filteredConferenceList:Object,conferenceData:{type:Object,value:function(){return{}}},_filterActive:{type:Boolean,value:!0,observer:'_filterData'},editing:Object}}static get observers(){return['conferenceListChanged(conferenceList.*)']}ready(){super.ready(),this.editing=null}_storeName(a){this._name=a.target.value}_storeLocation(a){this._location=a.target.value}_storeYear(a){this._year=a.target.value}_storeStartDate(a){this._startDate=a.target.value}_storeEndDate(a){this._endDate=a.target.value}_isEditing(a,b){return b===a}_isActive(a,b){return b&&(b===a||b.active)}_edit(a){var b=a.model.item;this.editing=b,this._name=b.name,this._location=b.location,this._year=b.year,this._startDate=b.startDate,this._endDate=b.endDate,this.$.grid.querySelector('#name-'+a.model.index).focus()}_save(a){this.conferenceData=a.model.item,this.conferenceData.name=this._name,this.conferenceData.location=this._location,this.conferenceData.year=this._year,this.conferenceData.startDate=this._startDate,this.conferenceData.endDate=this._endDate,this._saveConferenceData(),this.editing=null,this.$.grid.clearCache()}_cancel(){this.editing=null,this.$.grid.clearCache()}_toggleActive(a){this.conferenceData=a.model.item,this.conferenceData.active=!this.conferenceData.active,this._saveConferenceData()}_saveConferenceData(){var a=Object.assign({},this.conferenceData);delete a.$key,this.$.conferenceQuery.ref.child(this.conferenceData.$key).set(a).then(function(){this._filterData(),this.conferenceData=null,this.$.grid.clearCache()}.bind(this))}_create(){if(this.$.name.validate(),this.$.location.validate(),this.$.year.validate(),!this.$.name.invalid&&!this.$.location.invalid&&!this.$.year.invalid){if(!this.conferenceData.$key)return this.conferenceData.active=!0,this.$.conferenceDoc.saveValue('/conferenceDetails/').then(function(){this.$.conferenceDoc.reset(),this.$.grid.clearCache()}.bind(this));var a=Object.assign({},this.conferenceData);return delete a.$key,this.$.conferenceQuery.ref.child(this.conferenceData.$key).set(a).then(function(){this.$.conferenceDoc.reset(),this.$.grid.clearCache()}.bind(this))}}_delete(a){return this.conferenceData=a.model.item,this.$.conferenceQuery.ref.child(this.conferenceData.$key).set(null).then(function(){this.$.conferenceDoc.reset(),this.$.grid.clearCache()}.bind(this))}conferenceListChanged(){return this._filterData()}_filterData(){this.filteredConferenceList=this.conferenceList.filter(function(a){return a.active===this._filterActive}.bind(this)),this.$.grid.clearCache()}}window.customElements.define(SocmovAdminConferenceDetails.is,SocmovAdminConferenceDetails);</script></dom-module></body></html>